# byobu 使い方ガイド

byobuは、tmuxやscreenベースのターミナルマルチプレクサーです。セッションをバックグラウンドで実行し、再接続できるようになります。

## 基本操作

### セッションの開始・終了

```bash
# byobuセッションを開始
byobu

# セッションから抜ける（デタッチ）- プロセスは実行し続ける
# F6キーを押す
# または Ctrl+A を押してから D を押す

# セッションを終了（すべてのプロセスも終了）
# byobuセッション内で exit と入力
# または Ctrl+D を押す
```

### セッションの再接続

```bash
# 最後に使用したセッションに再接続
byobu

# セッション一覧を表示
byobu ls

# 特定のセッションに接続
byobu attach -t <session-name>

# セッション名を指定して新しいセッションを作成
byobu new -s <session-name>
```

## ウィンドウ操作

### ウィンドウの作成・切り替え

```
Ctrl+A を押してから:
  C  - 新しいウィンドウを作成
  N  - 次のウィンドウに移動
  P  - 前のウィンドウに移動
  0-9 - 指定した番号のウィンドウに移動
  W  - ウィンドウ一覧を表示
  ,  - ウィンドウ名を変更
```

### ウィンドウの分割（ペイン）

```
Ctrl+A を押してから:
  %  - ウィンドウを縦に分割（左右に分割）
  "  - ウィンドウを横に分割（上下に分割）
  O  - ペイン間を移動（順番に）
  ←↑↓→ - 方向キーでペイン間を移動
  X  - 現在のペインを閉じる
  Z  - 現在のペインを最大化/元に戻す
```

## 便利なショートカット

### コピー&ペースト

```
Ctrl+A を押してから:
  [  - コピーモードに入る（スペースで開始、Enterで終了）
  ]  - ペースト
```

### スクロール

```
Ctrl+A を押してから:
  [  - コピーモードに入る（矢印キーでスクロール）
  Esc  - コピーモードを終了
```

### その他の操作

```
Ctrl+A を押してから:
  ?  - ヘルプを表示（すべてのショートカットを表示）
  :  - コマンドモードに入る
  R  - セッションを再起動
  K  - 現在のウィンドウを閉じる
  S  - セッション一覧を表示
```

## 実践的な使い方

### MentraOS APPサーバーの起動

```bash
# 1. byobuを起動
byobu

# 2. プロジェクトディレクトリに移動
cd /home/hide-deployment/projects/MentraOS/AugmentOS-Cloud-Example-App

# 3. PATHを設定（必要に応じて）
export PATH="$HOME/.bun/bin:$PATH"

# 4. 開発サーバーを起動（ログも保存）
bun run dev:tee

# 5. F6でbyobuから抜ける（サーバーは動き続ける）
```

### ログの確認

```bash
# byobuに再接続
byobu

# 別のウィンドウでログを確認
Ctrl+A を押してから C  # 新しいウィンドウを作成
tail -f server.log

# ウィンドウ間を移動
Ctrl+A を押してから N  # 次のウィンドウ（サーバー）
Ctrl+A を押してから P  # 前のウィンドウ（ログ）
```

### 複数のプロセスを管理

```bash
# ウィンドウ1: サーバー
bun run dev:tee

# ウィンドウ2: ログ監視（Ctrl+A を押してから C）
tail -f server.log

# ウィンドウ3: その他の作業（Ctrl+A を押してから C）
# 何か作業

# ウィンドウ間を移動
Ctrl+A を押してから N  # 次のウィンドウ
Ctrl+A を押してから P  # 前のウィンドウ
Ctrl+A を押してから 0-9  # 番号で移動
```

## トラブルシューティング

### セッションが見つからない

```bash
# セッション一覧を確認
byobu ls

# すべてのセッションを確認（tmuxベースの場合）
tmux ls

# すべてのセッションを確認（screenベースの場合）
screen -ls
```

### セッションが応答しない

```bash
# 強制的にセッションを終了
byobu kill-session -t <session-name>

# すべてのセッションを終了
byobu kill-session -a
```

### キーバインドが効かない

byobuはデフォルトで`Ctrl+A`をプレフィックスキーとして使用します。
もし他のアプリケーション（例: screen）と競合する場合は、設定を変更できます。

```bash
# byobuの設定を編集
nano ~/.byobu/keybindings.tmux

# または
byobu-config
```

## よく使うコマンドまとめ

| 操作 | ショートカット |
|------|---------------|
| デタッチ（抜ける） | `F6` または `Ctrl+A` → `D` |
| 新しいウィンドウ | `Ctrl+A` → `C` |
| 次のウィンドウ | `Ctrl+A` → `N` |
| 前のウィンドウ | `Ctrl+A` → `P` |
| ウィンドウ一覧 | `Ctrl+A` → `W` |
| ウィンドウを縦分割 | `Ctrl+A` → `%` |
| ウィンドウを横分割 | `Ctrl+A` → `"` |
| ペイン間を移動 | `Ctrl+A` → `O` または矢印キー |
| コピーモード | `Ctrl+A` → `[` |
| ペースト | `Ctrl+A` → `]` |
| ヘルプ | `Ctrl+A` → `?` |
| 現在のウィンドウを閉じる | `Ctrl+A` → `K` |

## 参考リンク

- [byobu公式サイト](https://www.byobu.org/)
- [byobu GitHub](https://github.com/dustinkirkland/byobu)
- [tmux マニュアル](https://man.openbsd.org/tmux)

