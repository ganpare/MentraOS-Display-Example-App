<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentraOS App</title>
    <link rel="stylesheet" href="css/styles.css?v=20241104-3">
</head>
<body>
    <!-- トップページ -->
    <div class="container">
        <div id="topPage" class="page active">
            <h1>🏠 メインメニュー</h1>
            <div class="top-menu">
                <button class="menu-btn" id="textReaderBtn">📄 テキストリーダー</button>
                <button class="menu-btn" id="audioPlayerBtn">🎵 音声プレーヤー</button>
                <button class="menu-btn" id="btControllerBtn">🎮 Bluetoothコントローラー</button>
                <button class="menu-btn" id="settingsBtn">⚙️ ボタン設定</button>
            </div>
        </div>
        
        <!-- テキストリーダーページ -->
        <div id="textReaderPage" class="page">
            <button class="back-btn" id="backToTopBtn">← 戻る</button>
            <h1>📄 テキストファイル選択</h1>
        
            <div class="file-input-wrapper">
                <label for="fileInput" class="file-input-label">
                    📁 ファイルを選択
                </label>
                <input type="file" id="fileInput" accept=".txt,.text,.md,.markdown,.csv" />
            </div>
            
            <div class="text-input-wrapper">
                <textarea id="textInput" placeholder="または、ここにテキストを直接入力してください..."></textarea>
            </div>
            
            <button id="displayBtn">ARグラスに表示</button>
            
            <div id="navigationArea" class="navigation-area">
                <div class="nav-buttons">
                    <button id="prevBtn" class="prev-btn">← 前へ</button>
                    <button id="nextBtn" class="next-btn">次へ →</button>
                </div>
                <div id="pageInfo" class="page-info"></div>
            </div>
            
            <!-- ARデバイス表示エリア -->
            <div class="ar-display-area">
                <div class="ar-display-title">👓 ARデバイス表示プレビュー</div>
                <div class="ar-display-content" id="arDisplayContent"></div>
            </div>
        
            <div id="status" class="status"></div>
            <div id="fileInfo" class="file-info" style="display: none;"></div>
        </div>
        
        <!-- 音声プレーヤーページ -->
        <div id="audioPlayerPage" class="page">
            <button class="back-btn" id="backToTopBtn2">← 戻る</button>
            <h1>🎵 音声プレーヤー</h1>
            
            <!-- ディレクトリ選択画面 -->
            <div class="audio-directory-screen" id="audioDirectoryScreen">
                <div class="audio-directory-selector">
                    <button id="directoryBtn">📁 神威ディレクトリ</button>
                </div>
            </div>
            
            <!-- ファイル一覧画面 -->
            <div class="audio-file-list-screen" id="audioFileListScreen">
                <button class="back-btn" id="backToDirectoryBtn" style="margin-bottom: 15px;">← ディレクトリに戻る</button>
                
                <!-- フィルタ -->
                <div class="audio-filters">
                    <select id="monthFilter">
                        <option value="">全ての月</option>
                    </select>
                    <select id="speakerFilter">
                        <option value="">全ての話者</option>
                        <option value="luna">Luna</option>
                        <option value="professor">Professor</option>
                    </select>
                </div>
                
                <div class="audio-file-list" id="audioFileList">
                    <div style="text-align: center; color: #666; padding: 20px;">
                        ファイルを読み込み中...
                    </div>
                </div>
            </div>
            
            <div class="audio-player" id="audioPlayer">
                <audio id="audioElement" controls style="width: 100%;"></audio>
                <div class="current-time" id="currentTime">00:00 / 00:00</div>
                
                <div class="audio-controls">
                    <button id="playBtn" class="play-btn">▶️ 再生</button>
                    <button id="pauseBtn" class="pause-btn">⏸️ 一時停止</button>
                    <button id="skipForwardBtn" class="skip-btn">⏩ +10秒</button>
                    <button id="skipBackwardBtn" class="skip-btn">⏪ -10秒</button>
                    <button id="nextSubtitleBtn" class="subtitle-btn">⏭️ 次字幕</button>
                    <button id="prevSubtitleBtn" class="subtitle-btn">⏮️ 前字幕</button>
                    <button id="repeatSubtitleBtn" class="subtitle-btn">🔁 リピート</button>
                    <button id="speedBtn" class="speed-btn">⚡ 1.0x</button>
                </div>
                
                <div class="subtitle-display" id="subtitleDisplay">
                    字幕がここに表示されます
                </div>
            </div>
            
            <div id="audioStatus" class="status"></div>
        </div>
        
        <!-- Bluetoothコントローラーテストページ -->
        <div id="btControllerPage" class="page">
            <button class="back-btn" id="backToTopBtn3">← 戻る</button>
            <h1>🎮 Bluetoothコントローラーテスト</h1>
            
            <div class="bt-controller-status">
                <div class="status-indicator" id="connectionStatus">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">接続待機中...</span>
                </div>
            </div>
            
            <div class="bt-controller-info">
                <p>iOSのメディアコントロールイベントを受信して表示します。</p>
                <p>Bluetoothコントローラーを接続して、ボタンを押してください。</p>
            </div>
            
            <div class="bt-controller-test-buttons">
                <h3>テストボタン（シミュレーション）</h3>
                <div class="test-button-grid">
                    <button class="test-btn" data-event="playpause">⏯️ 再生/一時停止</button>
                    <button class="test-btn" data-event="nexttrack">⏭️ 次の曲</button>
                    <button class="test-btn" data-event="prevtrack">⏮️ 前の曲</button>
                    <button class="test-btn" data-event="skipforward">⏩ 早送り</button>
                    <button class="test-btn" data-event="skipbackward">⏪ 巻き戻し</button>
                    <button class="test-btn" data-event="play">▶️ 再生</button>
                    <button class="test-btn" data-event="pause">⏸️ 一時停止</button>
                    <button class="test-btn" data-event="stop">⏹️ 停止</button>
                </div>
            </div>
            
            <div class="bt-controller-event-log">
                <div class="event-log-header">
                    <h3>📋 イベントログ</h3>
                    <button class="clear-log-btn" id="clearLogBtn">クリア</button>
                </div>
                <div class="event-log-content" id="eventLogContent">
                    <div class="event-log-empty">イベントログがここに表示されます</div>
                </div>
            </div>
            
            <div id="btControllerStatus" class="status"></div>
        </div>
        
        <!-- ボタン設定ページ -->
        <div id="settingsPage" class="page">
            <button class="back-btn" id="backToTopBtn4">← 戻る</button>
            <h1>⚙️ ボタン設定</h1>
            
            <div class="settings-info">
                <p>Bluetoothコントローラーのボタンに機能を割り当てます。</p>
                <p>シングルクリックとダブルクリックで異なる機能を設定できます。</p>
            </div>
            
            <div class="settings-container" id="settingsContainer">
                <div class="settings-loading">設定を読み込み中...</div>
            </div>
            
            <div id="settingsStatus" class="status"></div>
        </div>
    </div>

    <!-- JavaScript モジュール -->
    <script src="js/utils.js?v=20241104-3"></script>
    <script src="js/main.js?v=20241104-3"></script>
    <script src="js/textReader/textReader.js?v=20241104-3"></script>
    <script src="js/audioPlayer/audioPlayer.js?v=20241104-3"></script>
    <script src="js/btController/btController.js?v=20241104-3"></script>
    <script src="js/settings/settings.js?v=20241104-3"></script>
    <script src="js/mediaControlHandler.js?v=20241104-3"></script>
</body>
</html>
